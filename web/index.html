<!doctype html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CRISIS38 ¬∑ Centre op√©rationnel Is√®re</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <main class="shell">
    <section id="home-view" class="home-wrap">
      <header class="home-topbar">
        <div class="brand">
          <p class="tag">Protection Civile ¬∑ Is√®re</p>
          <strong>CRISIS38</strong>
        </div>
        <button id="mobile-menu-btn" class="menu-toggle" type="button" aria-expanded="false" aria-controls="home-nav">‚ò∞</button>
        <nav id="home-nav" class="home-nav">
          <a href="#home-features">Fonctionnalit√©s</a>
          <a href="#home-connectors">Interconnexions</a>
          <a href="#home-actions">Actions</a>
          <button id="open-login-btn" type="button">Espace s√©curis√©</button>
        </nav>
      </header>

      <section class="home-hero">
        <div>
          <p class="tag">Poste de commandement num√©rique</p>
          <h1>Un outil op√©rationnel clair, accessible et connect√©</h1>
          <p class="lead">Tableau de bord unifi√© pour la vigilance m√©t√©o, les crues, la coordination des communes et la gestion des actions terrain en Is√®re.</p>
          <div class="hero-actions">
            <button id="hero-login-btn" type="button">Se connecter</button>
            <button id="scroll-actions-btn" type="button" class="ghost">Voir les proc√©dures rapides</button>
          </div>
        </div>
        <article class="hero-status panel">
          <h3>Simulation en direct</h3>
          <p>Niveau m√©t√©o <strong id="home-meteo-state">Vert</strong></p>
          <p>Niveau crues <strong id="home-river-state">Vert</strong></p>
          <p>Cellule active <strong id="home-cell-state">Veille</strong></p>
          <div class="simulator-controls" role="group" aria-label="Niveaux d'alerte">
            <button class="alert-btn active" data-level="vert" type="button">Vert</button>
            <button class="alert-btn" data-level="jaune" type="button">Jaune</button>
            <button class="alert-btn" data-level="orange" type="button">Orange</button>
            <button class="alert-btn" data-level="rouge" type="button">Rouge</button>
          </div>
        </article>
      </section>

      <section id="home-features" class="home-grid">
        <article class="panel feature-card"><h3>Menu structur√©</h3><p>Navigation claire entre situation, services, communes, main courante, carte et utilisateurs.</p></article>
        <article class="panel feature-card"><h3>Interop√©rabilit√©</h3><p>Connexion et consolidation des flux M√©t√©o-France, Vigicrues et services institutionnels.</p></article>
        <article class="panel feature-card"><h3>Accessibilit√©</h3><p>Contrastes renforc√©s, composants larges, lecture rapide des √©tats critiques et compatibilit√© mobile.</p></article>
      </section>

      <section id="home-connectors" class="panel connectors">
        <h2>√âcosyst√®me interconnect√©</h2>
        <p class="muted">Sources exploitables via API, flux institutionnels et portails m√©tiers.</p>
        <div class="connector-grid">
          <article><h4>M√©t√©o-France Vigilance</h4><p>Bulletins et niveaux de vigilance d√©partementale.</p></article>
          <article><h4>Vigicrues</h4><p>Stations hydrologiques et niveaux d'alerte eau.</p></article>
          <article><h4>Pr√©fecture de l'Is√®re</h4><p>Coordination institutionnelle et informations officielles.</p></article>
          <article><h4>G√©orisques</h4><p>Connaissance des al√©as naturels locaux.</p></article>
          <article><h4>Info Route Is√®re</h4><p>Suivi de circulation et coupures d'axes.</p></article>
          <article><h4>PCS / ORSEC</h4><p>R√©f√©rentiels internes pour la r√©ponse op√©rationnelle.</p></article>
        </div>
      </section>

      <section id="home-actions" class="panel quick-actions">
        <h2>Actions rapides</h2>
        <div class="actions-grid">
          <button class="quick-btn" data-message="‚úÖ Checklist COD charg√©e et pr√™te √† l'emploi.">Checklist COD</button>
          <button class="quick-btn" data-message="üìû Script d'appel pr√©fectoral pr√©par√©.">Alerter pr√©fecture</button>
          <button class="quick-btn" data-message="üöß Proc√©dure inondation affich√©e.">Proc√©dure inondation</button>
          <button class="quick-btn" data-message="üõ∞Ô∏è Canal inter-services activ√©.">Canal inter-services</button>
        </div>
        <p id="quick-result" class="quick-result">Cliquez sur une action pour obtenir une r√©ponse imm√©diate.</p>
      </section>
    </section>

    <section id="login-view" class="auth-wrap hidden" hidden>
      <form id="login-form" class="panel auth-card" method="post" action="#" autocomplete="off">
        <p class="tag">Protection Civile ¬∑ Is√®re</p>
        <h1>Connexion CRISIS38</h1>
        <p class="lead">Acc√®s au centre op√©rationnel et aux services connect√©s.</p>
        <label>Identifiant<input name="username" required /></label>
        <label>Mot de passe<input name="password" type="password" required /></label>
        <button type="submit">Connexion s√©curis√©e</button>
        <button id="back-home-btn" type="button" class="ghost">Retour accueil</button>
        <p id="login-error" class="error"></p>
      </form>

      <form id="password-form" class="panel auth-card hidden" hidden method="post" action="#" autocomplete="off">
        <h2>Nouveau mot de passe</h2>
        <label>Nouveau mot de passe<input name="new_password" type="password" minlength="8" required /></label>
        <button type="submit">Valider</button>
        <p id="password-error" class="error"></p>
      </form>
    </section>

    <section id="app-view" class="app hidden" hidden>
      <aside id="app-sidebar" class="panel sidebar">
        <div class="sidebar-header">
          <p class="tag">Centre de commandement</p>
          <h2>Is√®re ¬∑ 38</h2>
          <p class="muted">R√¥le <strong id="current-role">-</strong></p>
          <p class="muted">Commune <strong id="current-commune">Toutes</strong></p>
        </div>
        <nav class="side-nav" aria-label="Menu principal">
          <button class="menu-btn" data-target="situation-panel">Situation</button>
          <button class="menu-btn" data-target="services-panel">Services connect√©s</button>
          <button class="menu-btn" data-target="municipalities-panel">Communes</button>
          <button class="menu-btn" data-target="logs-panel">Main courante</button>
          <button class="menu-btn" data-target="map-panel">Carte Is√®re</button>
          <button class="menu-btn" data-target="users-panel">Utilisateurs</button>
        </nav>
        <button id="logout-btn" class="danger">D√©connexion</button>
      </aside>

      <section class="content">
        <header class="panel app-header">
          <button id="app-menu-btn" class="menu-toggle" type="button" aria-expanded="false" aria-controls="app-sidebar">‚ò∞ Menu</button>
          <div>
            <p class="tag">Pilotage en temps r√©el</p>
            <h1 id="panel-title">Situation op√©rationnelle</h1>
          </div>
          <div class="header-actions">
            <button id="refresh-btn" class="ghost" type="button">Actualiser</button>
            <p id="dashboard-error" class="error"></p>
          </div>
        </header>

        <section id="situation-panel" class="panel view">
          <div class="kpis">
            <article class="tile"><h3>Vigilance m√©t√©o</h3><p id="vigilance">-</p></article>
            <article class="tile"><h3>Niveau crues</h3><p id="crues">-</p></article>
            <article class="tile"><h3>Risque global</h3><p id="risk">-</p></article>
            <article class="tile"><h3>Communes en crise</h3><p id="crisis">0</p></article>
          </div>
          <h3>Derniers √©v√®nements</h3>
          <ul id="latest-logs" class="list"></ul>
        </section>

        <section id="services-panel" class="panel view hidden" hidden>
          <h3>√âcosyst√®me de donn√©es et services connect√©s (Is√®re)</h3>
          <div class="services-grid">
            <article class="service-card"><h4>M√©t√©o-France Vigilance</h4><p id="meteo-status">-</p><p id="meteo-info" class="muted"></p></article>
            <article class="service-card"><h4>Vigicrues</h4><p id="vigicrues-status">-</p><p id="vigicrues-info" class="muted"></p></article>
            <article class="service-card"><h4>Pr√©fecture de l'Is√®re</h4><p>Coordination institutionnelle</p><a href="https://www.isere.gouv.fr" target="_blank" rel="noreferrer">is√®re.gouv.fr</a></article>
            <article class="service-card"><h4>Vigicrues Flash</h4><p>Veille pluie-inondation</p><a href="https://www.vigicrues.gouv.fr" target="_blank" rel="noreferrer">vigicrues.gouv.fr</a></article>
            <article class="service-card"><h4>GEORISQUES</h4><p>Connaissance des al√©as locaux</p><a href="https://www.georisques.gouv.fr" target="_blank" rel="noreferrer">georisques.gouv.fr</a></article>
            <article class="service-card"><h4>Info route Is√®re</h4><p>Axes coup√©s et circulation</p><a href="https://www.itinisere.fr" target="_blank" rel="noreferrer">itinisere.fr</a></article>
          </div>
          <h4>Stations Vigicrues prioritaires</h4>
          <ul id="stations-list" class="list"></ul>
        </section>

        <section id="municipalities-panel" class="panel view hidden" hidden>
          <h3>Communes & fiches pratiques</h3>
          <form id="municipality-form" class="form" data-requires-edit>
            <input name="name" placeholder="Nom commune" required />
            <input name="manager" placeholder="Responsable" required />
            <input name="phone" placeholder="T√©l√©phone" required />
            <input name="email" placeholder="Email" type="email" required />
            <button type="submit">Ajouter</button>
          </form>
          <ul id="municipalities-list" class="list"></ul>
        </section>

        <section id="logs-panel" class="panel view hidden" hidden>
          <h3>Main courante</h3>
          <form id="log-form" class="form" data-requires-edit>
            <input name="event_type" placeholder="Type d'√©v√®nement" required />
            <input name="description" placeholder="Description op√©rationnelle" required />
            <button type="submit">Ajouter</button>
          </form>
          <ul id="logs-list" class="list"></ul>
        </section>

        <section id="map-panel" class="panel view hidden" hidden>
          <h3>Carte strat√©gique Is√®re</h3>
          <div class="map-layout">
            <svg class="isere-map" viewBox="0 0 420 520" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Carte stylis√©e Is√®re">
              <path id="isere-shape" d="M143 33l46 26 48-8 29 36 45 17-1 48 36 43-15 56-41 35-2 53-45 31-31 52-56 25-48-31-54-4-32-34 3-44-34-40 11-58 40-32 6-51 35-29 10-47z"/>
              <path class="river" d="M116 112c58 11 76 29 103 65 23 31 42 70 88 104"/>
              <path class="river" d="M205 76c-18 58-30 123-26 188"/>
              <circle id="grenoble-dot" cx="214" cy="230" r="7"/>
              <text x="225" y="233">Grenoble</text>
              <circle cx="127" cy="180" r="5" class="city"/><text x="137" y="183">Voiron</text>
              <circle cx="244" cy="298" r="5" class="city"/><text x="254" y="301">Vizille</text>
              <circle cx="178" cy="340" r="5" class="city"/><text x="188" y="343">La Mure</text>
            </svg>
            <div>
              <p>Niveau m√©t√©o <strong id="meteo-level">-</strong></p>
              <p>Niveau hydrologique <strong id="river-level">-</strong></p>
              <h4>Infos pratiques</h4>
              <ul class="list practical">
                <li>CODIS 38: 18 / 112</li>
                <li>Pr√©fecture: 04 76 60 34 00</li>
                <li>SAMU: 15</li>
                <li>R√©f√©rentiel ORSEC/PCS interne</li>
              </ul>
            </div>
          </div>
        </section>

        <section id="users-panel" class="panel view hidden" hidden>
          <h3>Comptes utilisateurs</h3>
          <table class="users-table">
            <thead><tr><th>Utilisateur</th><th>R√¥le</th><th>Commune</th><th>Cr√©√© le</th><th>Statut</th></tr></thead>
            <tbody id="users-table"></tbody>
          </table>
        </section>
      </section>
    </section>
  </main>
  <script src="/script.js"></script>
</body>
</html>
