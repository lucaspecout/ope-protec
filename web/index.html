<!doctype html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Veille Opérationnelle</title>
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <main class="layout">
    <section id="login-view" class="auth-wrapper">
      <form id="login-form" class="glass auth-card" method="post" action="#" autocomplete="off">
        <p class="eyebrow">Protection Civile de l'Isère</p>
        <h1>Centre de veille opérationnelle</h1>
        <p class="chip">Interface sécurisée · connexion chiffrée</p>
        <p class="help">Connectez-vous pour accéder au tableau de bord.</p>
        <label>Identifiant<input name="username" required /></label>
        <label>Mot de passe<input name="password" type="password" required /></label>
        <button type="submit">Se connecter</button>
        <p id="login-error" class="error"></p>
      </form>

      <form id="password-form" class="glass auth-card hidden" hidden method="post" action="#" autocomplete="off">
        <p class="eyebrow">Sécurité</p>
        <h2>Changement obligatoire</h2>
        <p class="help">Pour continuer, remplacez le mot de passe temporaire.</p>
        <label>Nouveau mot de passe<input name="new_password" type="password" minlength="8" required /></label>
        <button type="submit">Mettre à jour</button>
        <p id="password-error" class="error"></p>
      </form>
    </section>

    <section id="app-view" class="dashboard-shell hidden" hidden>
      <aside class="sidebar glass">
        <div>
          <p class="eyebrow">Protection Civile 38</p>
          <h2>Ops Dashboard</h2>
        </div>
        <nav class="menu">
          <button class="menu-btn active" data-target="dashboard-panel">Dashboard</button>
          <button class="menu-btn" data-target="municipalities-panel">Communes</button>
          <button class="menu-btn" data-target="logs-panel">Main courante</button>
          <button class="menu-btn" data-target="map-panel">Carte</button>
        </nav>
        <button id="logout-btn" class="logout">Déconnexion</button>
      </aside>

      <section class="content-area">
        <header class="hero glass">
          <p id="dashboard-error" class="error hero-error"></p>
          <h1>Tableau de pilotage en temps réel</h1>
          <p>Suivi synthétique des risques, des communes et des événements en cours.</p>
        </header>

        <section id="dashboard-panel" class="panel dashboard">
          <article class="card metric"><h2>Vigilance</h2><p id="vigilance">-</p></article>
          <article class="card metric"><h2>Niveau crues</h2><p id="crues">-</p></article>
          <article class="card metric"><h2>Risque global</h2><p id="risk">-</p></article>
          <article class="card metric"><h2>Communes en crise</h2><p id="crisis">0</p></article>
          <article class="card logs"><h2>Dernières entrées main courante</h2><ul id="logs" class="list"></ul></article>
        </section>

        <section id="municipalities-panel" class="panel hidden" hidden>
          <article class="card">
            <h2>Ajouter une commune</h2>
            <form id="municipality-form" class="inline-form">
              <input name="name" placeholder="Nom" required />
              <input name="phone" placeholder="Téléphone" required />
              <input name="email" type="email" placeholder="Email" required />
              <input name="manager" placeholder="Responsable" required />
              <button type="submit">Ajouter</button>
            </form>
          </article>
          <article class="card">
            <h2>Liste des communes</h2>
            <ul id="municipalities-list" class="list"></ul>
          </article>
        </section>

        <section id="logs-panel" class="panel hidden" hidden>
          <article class="card">
            <h2>Nouvelle entrée main courante</h2>
            <form id="log-form" class="inline-form">
              <input name="event_type" placeholder="Type d'évènement" required />
              <input name="description" placeholder="Description" required />
              <button type="submit">Ajouter</button>
            </form>
          </article>
        </section>

        <section id="map-panel" class="panel hidden" hidden>
          <article class="card">
            <h2>Carte opérationnelle</h2>
            <iframe
              title="Carte des opérations"
              src="https://www.openstreetmap.org/export/embed.html?bbox=5.3%2C44.8%2C6.7%2C45.7&layer=mapnik"
              class="map"
            ></iframe>
          </article>
        </section>
      </section>
    </section>
  </main>

  <script src="/script.js"></script>
</body>
</html>
